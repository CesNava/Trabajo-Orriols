---
title: "P FINAL QOG"
author: " Rubén Díaz y Jorge de Diego"
date: "2024-01-16"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


# PROYECTO DE TALLERES GRUPAL

El siguiente código es un archivo RMD sobre el proyecto de estudio de regresión lineal mediante el uso de la las librerías expuestas y explicadas en clase: tidyverse, dplyr, tidyr, forcats, etc.

### Librerías

```{r}
library(pacman)
p_load(tidyverse, dplyr, forcats, haven)
```

### Descarga de datos QoG

```{r}
df <- read_dta("qog_std_cs_jan23_stata14.dta") #Usando la Cross-Section
```


### Especificación de la variabe dependiente: índice de globalización (continua numérica)


```{r}
df <- df |>
 rename(glob_index = dr_ig) |> #recodificamos con la función rename de dplyr
 filter(glob_index != "NA") #eliminamos valores perdidos con la función filter de dplyr

summary(df$glob_index) #visualizamos si la variable esta correctamente especificada

```

### Especificamos las variables explicativas

CULTURAL DIVERSITY (continua numérica)

```{r}
df <- df |> 
 rename(cult_div = fe_cultdiv) |> #recodificamos con la función rename de dplyr
 filter(cult_div != "NA") #eliminamos valores perdidos con la función filter de dplyr
 
summary(df$cult_div) #visualizamos si la variable esta correctamente especificada
```

### MODELO DE REGRESIÓN 1 (REG SIMPLE)

Hacemos una regresión simple para ver la relación y el impacto de la diversidad cultural sobre cuan globalizado está un país

```{r}
model.1 <- lm(glob_index ~ cult_div, data = df)

summary(model.1)
```


```{r}
df <- df |> rename(cgini = wdi_gini) |> 
  filter(cgini != "NA")
```

```{r}
summary(df$cgini)
```
```{r}
# df <- df |> rename(der_mujer = ciri_wecon) |> 
   # filter(der_mujer != "NA")
```

```{r}
 df <- df |> rename(estabilidad = wbgi_pve)
```

```{r}
 df <- df |> mutate(estabilidad = case_when(
   estabilidad >=0 ~ 1,
     estabilidad < 0 ~ 0,
     estabilidad == "NA" ~ NA))
df$estabilidad <- factor(df$estabilidad,
                         levels = 0:1,
                         labels = c("Inestable", "Estable")) #USAMOS R BASE ¿ESCRIBIR CORREO?
```

```{r}
summary(df$estabilidad)
```
